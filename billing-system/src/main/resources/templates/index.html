<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap Form Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXhW+ALEwIH" crossorigin="anonymous">
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">Payment Form</h1>
      <!-- Using a table to layout form elements -->
      <div id="paymentForm">
        <table class="table">
          <!-- Payment Method -->
          <tr>
            <td><label for="paymentMethod" class="form-label">Payment Method</label></td>
            <td>
              <select class="form-select" id="paymentMethod" name="paymentMethod">
                <option value="CREDIT_CARD">Credit Card</option>
                <option value="DEBIT_CARD">Debit Card</option>
                <option value="BANK_TRANSFER">Bank Transfer</option>
                <option value="UPI">UPI</option>
              </select>
            </td>
          </tr>

          <!-- Amount Paid -->
          <tr>
            <td><label for="amountPaid" class="form-label">Amount Paid</label></td>
            <td>
              <input type="number" step="0.01" class="form-control" id="amountPaid" name="amountPaid" placeholder="Enter amount">
            </td>
          </tr>

          <!-- Payment Gateway -->
          <tr>
            <td><label for="paymentGateway" class="form-label">Payment Gateway</label></td>
            <td>
              <select class="form-select" id="paymentGateway" name="paymentGateway">
                <option value="RAZOR_PAY">Razor Pay</option>
              </select>
            </td>
          </tr>

          <!-- Status -->
          <tr>
            <td><label for="status" class="form-label">Status</label></td>
            <td>
              <select class="form-select" id="status" name="status">
                <option value="COMPLETED">Completed</option>
                <option value="PENDING">Pending</option>
                <option value="FAILED">Failed</option>
              </select>
            </td>
          </tr>

          <!-- Customer ID -->
          <tr>
            <td><label for="customerid" class="form-label">Customer ID</label></td>
            <td>
              <input type="text" class="form-control" id="customerid" name="customerid" placeholder="Enter customer ID">
            </td>
          </tr>

          <!-- Submit Button -->
          <tr>
            <td colspan="2">
              <button type="button" class="btn btn-primary" id="rzp-button1">Submit</button>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Razorpay script -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        async function createpayment() {
            console.log('_____Payment_____');
            const response = await fetch('http://localhost:10000/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    paymentMethod: document.getElementById('paymentMethod').value,
                    amountPaid: parseFloat(document.getElementById('amountPaid').value),
                    paymentGateway: document.getElementById('paymentGateway').value,
                    status: document.getElementById('status').value,
                    customerid: parseInt(document.getElementById('customerid').value),
                    currency: 'INR'
                })
            });

            const payment = await response.json();
            console.log('_____Payment-Completed_____');
            return payment;
        }

        document.getElementById('rzp-button1').onclick = async function (e) {
            console.log(3);
            const payment = await createpayment();
            console.log(payment);

            var options = {
                "key": "rzp_test_16L735QuRrQPZT",
                "amount": payment.amount,
                "currency": 'INR',
                "name": "ITIT",
                "description": "Payment Testing",
                "order_id": payment.razorpayid,
                "receipt": payment.customer
            };

            var razp1 = new Razorpay(options);
            razp1.open();
            e.preventDefault();
        }
    </script>

    <!-- Bootstrap script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
